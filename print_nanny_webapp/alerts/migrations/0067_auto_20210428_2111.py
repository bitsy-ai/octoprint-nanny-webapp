# Generated by Django 3.1.7 on 2021-04-29 04:11

from django.db import migrations, models
import django.db.models.deletion
import print_nanny_webapp.alerts.models
import print_nanny_webapp.utils.fields


class Migration(migrations.Migration):

    dependencies = [
        ('remote_control', '0043_auto_20210428_1513'),
        ('alerts', '0066_printprogresseventsettings_squashed_0077_auto_20210427_2315'),
    ]

    operations = [
        migrations.CreateModel(
            name='PrintStatusAlert',
            fields=[
                ('alert_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='alerts.alert')),
                ('event_subtype', models.CharField(choices=[('PrintProgress', 'PrintProgress'), ('PrintDone', 'PrintDone'), ('PrintFailed', 'PrintFailed'), ('PrintPaused', 'PrintPaused'), ('PrintResumed', 'PrintResumed'), ('PrintStarted', 'PrintStarted')], max_length=36)),
                ('annotated_video', models.FileField(upload_to=print_nanny_webapp.alerts.models._upload_to)),
                ('print_session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='remote_control.printsession')),
            ],
            bases=('alerts.alert',),
        ),
        migrations.RemoveField(
            model_name='manualvideouploadalert',
            name='alert_ptr',
        ),
        migrations.RemoveField(
            model_name='printsessionalert',
            name='alert_ptr',
        ),
        migrations.RemoveField(
            model_name='printsessionalert',
            name='print_session',
        ),
        migrations.AlterField(
            model_name='alert',
            name='event_type',
            field=models.CharField(choices=[('PrintHealth', 'Print health alerts'), ('PrintStatus', 'Print status updates (started, percent progress, paused, resumed, cancelling, cancelled, failed, done)')], max_length=255, null=True),
        ),
        migrations.AlterField(
            model_name='alerteventsettings',
            name='event_types',
            field=print_nanny_webapp.utils.fields.ChoiceArrayField(base_field=models.CharField(choices=[('PrintHealth', 'Print health alerts'), ('PrintStatus', 'Print status updates (started, percent progress, paused, resumed, cancelling, cancelled, failed, done)')], max_length=255), blank=True, default=('PrintHealth', 'PrintStatus'), size=None),
        ),
        migrations.DeleteModel(
            name='AlertPlot',
        ),
        migrations.DeleteModel(
            name='ManualVideoUploadAlert',
        ),
        migrations.DeleteModel(
            name='PrintSessionAlert',
        ),
        migrations.AddConstraint(
            model_name='printstatusalert',
            constraint=models.UniqueConstraint(fields=('print_session', 'event_subtype'), name='unique_alert_type_per_print_session'),
        ),
    ]
